<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–ò–®–ò–ù–ê | –ü–æ—Å—Ç–∞–ø–æ–∫–∞–ª–∏–ø—Ç–∏—á–µ—Å–∫–∏–π –∫–ª–∏–∫–µ—Ä</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            user-select: none;
        }

        :root {
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-card: #2a2a2a;
            --text-primary: #ffffff;
            --text-secondary: #aaaaaa;
            --accent-green: #00ff88;
            --accent-yellow: #ffcc00;
            --accent-red: #ff4444;
            --accent-blue: #4488ff;
            --noise-low: #00ff88;
            --noise-medium: #ffcc00;
            --noise-high: #ff4444;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        body {
            background: linear-gradient(135deg, var(--bg-primary) 0%, #1a0f1a 100%);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255, 0, 100, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(0, 200, 255, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
            padding-bottom: 100px;
        }

        /* –®–∞–ø–∫–∞ */
        .header {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            background: rgba(26, 26, 26, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .header::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(
                45deg,
                transparent 30%,
                rgba(255, 255, 255, 0.03) 50%,
                transparent 70%
            );
            animation: shine 8s infinite linear;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .title {
            font-size: 2.5rem;
            font-weight: 900;
            background: linear-gradient(45deg, var(--accent-blue), var(--accent-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            text-shadow: 0 0 30px rgba(0, 200, 255, 0.3);
        }

        .subtitle {
            color: var(--text-secondary);
            font-size: 1rem;
            margin-bottom: 15px;
        }

        /* –ö–Ω–æ–ø–∫–∞ –∫–ª–∏–∫–∞ - –ù–ê –í–ï–†–•–£ */
        .click-area-main {
            margin: 20px 0 30px 0;
            text-align: center;
            position: relative;
            z-index: 10;
        }

        .click-button-main {
            width: 180px;
            height: 180px;
            background: radial-gradient(circle at center, 
                rgba(68, 136, 255, 0.2) 0%, 
                rgba(26, 26, 26, 0.9) 70%);
            border-radius: 50%;
            border: 4px solid transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            box-shadow: 
                0 0 80px rgba(0, 200, 255, 0.3),
                inset 0 0 50px rgba(255, 255, 255, 0.1);
        }

        .click-button-main:active {
            transform: scale(0.92);
            box-shadow: 
                0 0 120px rgba(0, 200, 255, 0.5),
                inset 0 0 70px rgba(255, 255, 255, 0.2);
        }

        .click-button-main.panic {
            animation: panicPulse 0.5s infinite;
            border-color: var(--accent-red) !important;
        }

        @keyframes panicPulse {
            0%, 100% { 
                box-shadow: 
                    0 0 80px rgba(255, 68, 68, 0.4),
                    inset 0 0 50px rgba(255, 255, 255, 0.1);
            }
            50% { 
                box-shadow: 
                    0 0 120px rgba(255, 68, 68, 0.8),
                    inset 0 0 70px rgba(255, 255, 255, 0.2);
            }
        }

        .click-icon-main {
            font-size: 3.5rem;
            transition: transform 0.3s;
        }

        .click-button-main:hover .click-icon-main {
            transform: scale(1.1);
        }

        .click-label {
            margin-top: 15px;
            font-size: 1.1rem;
            color: var(--text-secondary);
            font-weight: 500;
        }

        .click-description {
            margin-top: 10px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            min-height: 20px;
            padding: 5px;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.2);
        }

        /* –®—É–º–æ–º–µ—Ç—Ä */
        .noise-meter {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 2px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }

        .noise-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .noise-icon {
            font-size: 2rem;
            transition: transform 0.3s;
        }

        .noise-bar-container {
            height: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }

        .noise-bar {
            height: 100%;
            width: 0%;
            border-radius: 15px;
            transition: width 0.5s ease, background 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        .noise-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(255, 255, 255, 0.2) 50%, 
                transparent 100%);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .noise-warning {
            text-align: center;
            margin-top: 10px;
            padding: 10px;
            border-radius: 10px;
            font-weight: bold;
            transition: all 0.3s;
            opacity: 0;
            transform: translateY(-10px);
            background: rgba(0, 0, 0, 0.3);
        }

        .noise-warning.show {
            opacity: 1;
            transform: translateY(0);
        }

        /* –†–µ—Å—É—Ä—Å—ã - –ü–û–î –∫–Ω–æ–ø–∫–æ–π */
        .resources-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 25px 0;
        }

        .resource-card {
            background: rgba(42, 42, 42, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .resource-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent-blue);
            box-shadow: 0 10px 20px rgba(68, 136, 255, 0.2);
        }

        .resource-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .resource-name {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .resource-value {
            font-size: 2rem;
            font-weight: bold;
            background: linear-gradient(45deg, #fff, var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* –£–ª—É—á—à–µ–Ω–∏—è */
        .upgrades-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 25px 0;
        }

        .upgrade-card {
            background: rgba(42, 42, 42, 0.8);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid transparent;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .upgrade-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .upgrade-card.owned {
            border-color: var(--accent-green);
        }

        .upgrade-card.locked {
            opacity: 0.6;
            filter: grayscale(0.5);
        }

        .upgrade-icon {
            font-size: 2rem;
            margin-bottom: 15px;
        }

        .upgrade-name {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .upgrade-desc {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 15px;
            line-height: 1.4;
        }

        .upgrade-cost {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .cost-item {
            background: rgba(0, 0, 0, 0.3);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .cost-item.affordable {
            background: rgba(0, 255, 136, 0.2);
            color: var(--accent-green);
        }

        .upgrade-button {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 10px;
            background: linear-gradient(45deg, var(--accent-blue), #667eea);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .upgrade-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(68, 136, 255, 0.4);
        }

        .upgrade-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* –ê–≤—Ç–æ–ø–æ–∏—Å–∫ */
        .autosearch-panel {
            background: rgba(26, 26, 26, 0.9);
            border-radius: 20px;
            padding: 25px;
            margin: 25px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .autosearch-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            background: rgba(42, 42, 42, 0.5);
            border-radius: 15px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .autosearch-toggle:hover {
            background: rgba(42, 42, 42, 0.8);
        }

        .toggle-switch {
            width: 60px;
            height: 30px;
            background: rgba(255, 68, 68, 0.3);
            border-radius: 15px;
            position: relative;
            transition: all 0.3s;
        }

        .toggle-switch.active {
            background: rgba(0, 255, 136, 0.3);
        }

        .toggle-slider {
            width: 26px;
            height: 26px;
            background: white;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: transform 0.3s;
        }

        .toggle-switch.active .toggle-slider {
            transform: translateX(30px);
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        .particle {
            position: absolute;
            pointer-events: none;
            opacity: 0;
            z-index: 100;
        }

        .float-up {
            animation: floatUp 1s ease-out forwards;
        }

        @keyframes floatUp {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) scale(0);
                opacity: 0;
            }
        }

        .shake {
            animation: shake 0.3s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-3px); }
            20%, 40%, 60%, 80% { transform: translateX(3px); }
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(42, 42, 42, 0.95);
            backdrop-filter: blur(10px);
            border-left: 4px solid var(--accent-green);
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            transform: translateX(150%);
            transition: transform 0.5s;
            z-index: 1000;
            max-width: 300px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            border-left-color: var(--accent-red);
        }

        .notification.warning {
            border-left-color: var(--accent-yellow);
        }

        /* –ê—Ç–∞–∫–∞ */
        .attack-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 0, 0, 0.2);
            backdrop-filter: blur(5px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            animation: redPulse 0.2s infinite;
        }

        @keyframes redPulse {
            0%, 100% { background: rgba(255, 0, 0, 0.2); }
            50% { background: rgba(255, 0, 0, 0.4); }
        }

        .attack-modal {
            background: rgba(0, 0, 0, 0.9);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 90%;
            border: 3px solid var(--accent-red);
            box-shadow: 0 0 100px rgba(255, 0, 0, 0.5);
            animation: modalAppear 0.3s;
        }

        @keyframes modalAppear {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* –¢–∞–±—ã */
        .tabs {
            display: flex;
            gap: 10px;
            margin: 30px 0;
            flex-wrap: wrap;
            background: rgba(26, 26, 26, 0.8);
            padding: 15px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tab {
            padding: 12px 25px;
            background: rgba(42, 42, 42, 0.5);
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
            border: 2px solid transparent;
            flex: 1;
            text-align: center;
            min-width: 120px;
        }

        .tab:hover {
            background: rgba(42, 42, 42, 0.8);
        }

        .tab.active {
            background: rgba(68, 136, 255, 0.2);
            border-color: var(--accent-blue);
            color: var(--accent-blue);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .tab-content.active {
            display: block;
        }

        /* –ü—Ä–æ–≥—Ä–µ—Å—Å –¥–Ω—è */
        .day-info {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }

        .day-box, .survivors-box {
            text-align: center;
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 15px;
            flex: 1;
            margin: 0 5px;
        }

        .day-label, .survivors-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .day-value, .survivors-value {
            font-size: 2rem;
            font-weight: bold;
            background: linear-gradient(45deg, var(--accent-blue), var(--accent-green));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è */
        @media (max-width: 600px) {
            .container {
                padding: 10px;
            }
            
            .click-button-main {
                width: 150px;
                height: 150px;
            }
            
            .click-icon-main {
                font-size: 3rem;
            }
            
            .resources-grid {
                grid-template-columns: 1fr;
            }
            
            .upgrades-grid {
                grid-template-columns: 1fr;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                width: 100%;
                min-width: auto;
            }
            
            .day-info {
                flex-direction: column;
                gap: 10px;
            }
            
            .day-box, .survivors-box {
                margin: 0;
            }
        }

        /* –ö–ª–∏–∫-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ */
        .click-notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 20px 30px;
            border-radius: 15px;
            border: 2px solid var(--accent-green);
            box-shadow: 0 0 50px rgba(0, 255, 136, 0.5);
            z-index: 1500;
            text-align: center;
            display: none;
            animation: clickNotify 1s ease-out;
        }

        @keyframes clickNotify {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.5);
            }
            50% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1.1);
            }
            100% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .click-reward-item {
            display: inline-flex;
            align-items: center;
            margin: 0 5px;
            font-size: 1.5rem;
            animation: rewardFloat 0.5s ease-out;
        }

        @keyframes rewardFloat {
            0% { transform: translateY(0); opacity: 0; }
            100% { transform: translateY(-20px); opacity: 1; }
        }

        /* –≠—Ñ—Ñ–µ–∫—Ç —Å–≤–µ—á–µ–Ω–∏—è –∫–Ω–æ–ø–∫–∏ */
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 80px rgba(0, 200, 255, 0.3); }
            50% { box-shadow: 0 0 100px rgba(0, 200, 255, 0.5); }
        }

        .click-button-main.glow {
            animation: glow 2s infinite;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –®–∞–ø–∫–∞ -->
        <div class="header">
            <h1 class="title">üîá –¢–ò–®–ò–ù–ê</h1>
            <p class="subtitle">–ü–æ—Å—Ç–∞–ø–æ–∫–∞–ª–∏–ø—Ç–∏—á–µ—Å–∫–∏–π –∫–ª–∏–∫–µ—Ä –≤—ã–∂–∏–≤–∞–Ω–∏—è</p>
            
            <div class="day-info">
                <div class="day-box">
                    <div class="day-label">–î–µ–Ω—å</div>
                    <div id="day" class="day-value">1</div>
                </div>
                <div class="survivors-box">
                    <div class="survivors-label">–í—ã–∂–∏–≤—à–∏–µ</div>
                    <div id="survivors" class="survivors-value">1</div>
                </div>
            </div>
        </div>

        <!-- –ì–õ–ê–í–ù–ê–Ø –ö–ù–û–ü–ö–ê –ö–õ–ò–ö–ê - –í–´–®–ï –í–°–ï–ì–û -->
        <div class="click-area-main">
            <div id="clickButtonMain" class="click-button-main glow">
                <div class="click-icon-main">üîá</div>
            </div>
            <div class="click-label">–ò–°–ö–ê–¢–¨ –ü–†–ò–ü–ê–°–´</div>
            <div id="clickDescription" class="click-description">
                –ù–∞–∂–º–∏—Ç–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤
            </div>
        </div>

        <!-- –®—É–º–æ–º–µ—Ç—Ä -->
        <div class="noise-meter">
            <div class="noise-header">
                <div>
                    <div style="font-size: 0.9rem; color: var(--text-secondary);">–£—Ä–æ–≤–µ–Ω—å —à—É–º–∞</div>
                    <div id="noisePercent" style="font-size: 1.5rem; font-weight: bold;">0%</div>
                </div>
                <div id="noiseIcon" class="noise-icon">üîá</div>
            </div>
            
            <div class="noise-bar-container">
                <div id="noiseBar" class="noise-bar" style="width: 0%; background: var(--noise-low);"></div>
            </div>
            
            <div id="noiseWarning" class="noise-warning">
                <!-- –°–æ–æ–±—â–µ–Ω–∏—è –ø–æ—è–≤–ª—è—é—Ç—Å—è –∑–¥–µ—Å—å -->
            </div>
        </div>

        <!-- –¢–∞–±—ã -->
        <div class="tabs">
            <div class="tab active" onclick="switchTab('resources')">üì¶ –†–µ—Å—É—Ä—Å—ã</div>
            <div class="tab" onclick="switchTab('upgrades')">üõ† –£–ª—É—á—à–µ–Ω–∏—è</div>
            <div class="tab" onclick="switchTab('autosearch')">ü§ñ –ê–≤—Ç–æ–ø–æ–∏—Å–∫</div>
            <div class="tab" onclick="switchTab('stats')">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ -->
        <div id="resourcesTab" class="tab-content active">
            <div class="resources-grid">
                <div class="resource-card">
                    <div class="resource-icon">‚ö°</div>
                    <div class="resource-name">–≠–ù–ï–†–ì–ò–Ø</div>
                    <div id="energy" class="resource-value">10</div>
                </div>
                <div class="resource-card">
                    <div class="resource-icon">ü•´</div>
                    <div class="resource-name">–ü–†–û–î–£–ö–¢–´</div>
                    <div id="food" class="resource-value">5</div>
                </div>
                <div class="resource-card">
                    <div class="resource-icon">üîß</div>
                    <div class="resource-name">–î–ï–¢–ê–õ–ò</div>
                    <div id="parts" class="resource-value">0</div>
                </div>
                <div class="resource-card">
                    <div class="resource-icon">üíä</div>
                    <div class="resource-name">–ú–ï–î–ò–ö–ê–ú–ï–ù–¢–´</div>
                    <div id="meds" class="resource-value">0</div>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ —É–ª—É—á—à–µ–Ω–∏–π -->
        <div id="upgradesTab" class="tab-content">
            <div class="upgrades-grid">
                <!-- –£–ª—É—á—à–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –∞–≤—Ç–æ–ø–æ–∏—Å–∫–∞ -->
        <div id="autosearchTab" class="tab-content">
            <div class="autosearch-panel">
                <h3 style="margin-bottom: 20px; text-align: center;">ü§ñ –ê–í–¢–û–ü–û–ò–°–ö</h3>
                
                <div class="autosearch-toggle" onclick="toggleAutosearch('robot')">
                    <div>
                        <div style="font-weight: bold;">–†–æ–±–æ—Ç-—Å–±–æ—Ä—â–∏–∫</div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">
                            +2 –¥–µ—Ç–∞–ª–∏/—á–∞—Å | –®—É–º: +1%/—á–∞—Å
                        </div>
                    </div>
                    <div class="toggle-switch" id="robotSwitch">
                        <div class="toggle-slider"></div>
                    </div>
                </div>

                <div class="autosearch-toggle" onclick="toggleAutosearch('watch')">
                    <div>
                        <div style="font-weight: bold;">–ù–æ—á–Ω–æ–π –¥–æ–∑–æ—Ä</div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">
                            +3 —ç–Ω–µ—Ä–≥–∏–∏/—á–∞—Å | –®—É–º: +0.5%/—á–∞—Å
                        </div>
                    </div>
                    <div class="toggle-switch" id="watchSwitch">
                        <div class="toggle-slider"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
        <div id="statsTab" class="tab-content">
            <div style="background: rgba(42, 42, 42, 0.8); padding: 25px; border-radius: 20px;">
                <h3 style="margin-bottom: 20px; text-align: center;">üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê</h3>
                
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-bottom: 25px;">
                    <div style="text-align: center;">
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">–ö–ª–∏–∫–æ–≤</div>
                        <div id="statClicks" style="font-size: 2rem; font-weight: bold;">0</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">–ê—Ç–∞–∫</div>
                        <div id="statAttacks" style="font-size: 2rem; font-weight: bold;">0</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">–î–Ω–µ–π</div>
                        <div id="statDays" style="font-size: 2rem; font-weight: bold;">1</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">–®—É–º –º–∞–∫—Å.</div>
                        <div id="statMaxNoise" style="font-size: 2rem; font-weight: bold;">0%</div>
                    </div>
                </div>

                <h4 style="margin: 20px 0 10px 0; color: var(--text-secondary);">üèÜ –î–û–°–¢–ò–ñ–ï–ù–ò–Ø</h4>
                <div id="achievements" style="display: flex; flex-direction: column; gap: 10px;">
                    <div style="
                        background: rgba(0, 255, 136, 0.1);
                        padding: 10px 15px;
                        border-radius: 10px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                        border: 1px solid rgba(0, 255, 136, 0.3);
                    ">
                        <div>‚úÖ</div>
                        <div>
                            <div style="font-weight: bold;">–ù–æ–≤–æ–±—Ä–∞–Ω–µ—Ü</div>
                            <div style="font-size: 0.8rem; color: var(--text-secondary);">–°–¥–µ–ª–∞—Ç—å –ø–µ—Ä–≤—ã–π –∫–ª–∏–∫</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –û–≤–µ—Ä–ª–µ–π –∞—Ç–∞–∫–∏ -->
    <div id="attackOverlay" class="attack-overlay">
        <div class="attack-modal">
            <div style="font-size: 3rem; margin-bottom: 20px;">üëπ</div>
            <h2 style="color: var(--accent-red); margin-bottom: 20px;">–ê–¢–ê–ö–ê!</h2>
            <p style="margin-bottom: 30px; line-height: 1.5;">
                –°—É—â–µ—Å—Ç–≤–∞ —É—Å–ª—ã—à–∞–ª–∏ –≤–∞—Å!<br>
                –û–Ω–∏ –ª–æ–º–∞—é—Ç –¥–≤–µ—Ä—å –±—É–Ω–∫–µ—Ä–∞!
            </p>
            <div id="attackResult" style="margin-bottom: 30px; padding: 20px; background: rgba(255, 68, 68, 0.1); border-radius: 10px;">
                <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç –∞—Ç–∞–∫–∏ -->
            </div>
            <button onclick="closeAttack()" style="
                padding: 15px 40px;
                background: linear-gradient(45deg, var(--accent-red), #ff0066);
                border: none;
                border-radius: 50px;
                color: white;
                font-weight: bold;
                font-size: 1.1rem;
                cursor: pointer;
                transition: all 0.3s;
            ">
                –ü–†–û–î–û–õ–ñ–ò–¢–¨
            </button>
        </div>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="notification" class="notification">
        <div id="notificationText">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</div>
    </div>

    <!-- –ö–ª–∏–∫-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ -->
    <div id="clickNotification" class="click-notification">
        <div id="clickReward" style="font-size: 1.8rem; font-weight: bold;">
            <!-- –ù–∞–≥—Ä–∞–¥—ã –ø–æ—è–≤–ª—è—é—Ç—Å—è –∑–¥–µ—Å—å -->
        </div>
    </div>

    <script>
        // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
        let tg = null;
        let gameState = {
            day: 1,
            survivors: 1,
            resources: {
                energy: 10,
                food: 5,
                parts: 0,
                meds: 0
            },
            noise: 0,
            upgrades: [],
            autosearch: {
                robot: false,
                watch: false
            },
            stats: {
                clicks: 0,
                attacks: 0,
                maxNoise: 0
            },
            lastClickTime: Date.now(),
            nextDayTime: Date.now() + 24 * 60 * 60 * 1000 // –ß–µ—Ä–µ–∑ 24 —á–∞—Å–∞
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        function initTelegram() {
            if (window.Telegram && window.Telegram.WebApp) {
                tg = Telegram.WebApp;
                tg.expand();
                tg.ready();
                
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ü–≤–µ—Ç–æ–≤—É—é —Ç–µ–º—É
                if (tg.colorScheme === 'dark') {
                    document.documentElement.style.setProperty('--bg-primary', '#0a0a0a');
                    document.documentElement.style.setProperty('--bg-secondary', '#1a1a1a');
                }
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
                loadGameState();
            } else {
                // –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏ –±–µ–∑ Telegram
                console.log('Telegram Web App –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω, –∑–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ –æ—Ç–ª–∞–¥–∫–∏');
            }
        }

        // ==================== –°–û–•–†–ê–ù–ï–ù–ò–ï ====================
        function saveGameState() {
            localStorage.setItem('silenceGameState', JSON.stringify(gameState));
            if (tg) {
                tg.sendData(JSON.stringify(gameState));
            }
        }

        function loadGameState() {
            const saved = localStorage.getItem('silenceGameState');
            if (saved) {
                const parsed = JSON.parse(saved);
                gameState = { ...gameState, ...parsed };
                updateUI();
            }
        }

        // ==================== –û–°–ù–û–í–ù–ê–Ø –ú–ï–•–ê–ù–ò–ö–ê ====================
        function handleClick() {
            const now = Date.now();
            if (now - gameState.lastClickTime < 100) return; // –ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞
            
            gameState.lastClickTime = now;
            
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤
            gameState.stats.clicks++;
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–∞–≥—Ä–∞–¥—É
            const rewards = calculateClickRewards();
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ—Å—É—Ä—Å—ã
            for (const [resource, amount] of Object.entries(rewards)) {
                gameState.resources[resource] += amount;
            }
            
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —à—É–º (—É—á–∏—Ç—ã–≤–∞—è —É–ª—É—á—à–µ–Ω–∏—è)
            let noiseIncrease = 5;
            if (gameState.upgrades.includes('soundproofing')) {
                noiseIncrease = 4;
            }
            
            gameState.noise = Math.min(100, gameState.noise + noiseIncrease);
            if (gameState.noise > gameState.stats.maxNoise) {
                gameState.stats.maxNoise = gameState.noise;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            updateUI();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –∫–ª–∏–∫–∞
            showClickAnimation(rewards);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ –∫–ª–∏–∫–∞
            updateClickDescription();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞—Ç–∞–∫—É
            if (gameState.noise >= 100) {
                triggerAttack();
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            saveGameState();
            
            // –í–∏–±—Ä–æ–æ—Ç–∫–ª–∏–∫ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)
            if (tg && tg.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('light');
            }
        }

        function calculateClickRewards() {
            const baseRewards = {
                energy: Math.floor(Math.random() * 3) + 1,
                food: Math.floor(Math.random() * 2) + 1,
                parts: Math.random() > 0.7 ? 1 : 0,
                meds: Math.random() > 0.9 ? 1 : 0
            };
            
            // –£–¥–≤–æ–µ–Ω–∏–µ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —É–ª—É—á—à–µ–Ω–∏—è
            if (gameState.upgrades.includes('quiet_tools')) {
                for (const key in baseRewards) {
                    baseRewards[key] *= 2;
                }
            }
            
            // –ë–æ–Ω—É—Å –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–º —à—É–º–µ (—Ä–∏—Å–∫/–Ω–∞–≥—Ä–∞–¥–∞)
            if (gameState.noise > 70) {
                for (const key in baseRewards) {
                    baseRewards[key] = Math.floor(baseRewards[key] * 1.5);
                }
            }
            
            return baseRewards;
        }

        function showClickAnimation(rewards) {
            const button = document.getElementById('clickButtonMain');
            const notification = document.getElementById('clickNotification');
            const rewardDiv = document.getElementById('clickReward');
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏
            button.classList.add('shake');
            setTimeout(() => button.classList.remove('shake'), 300);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞–≥—Ä–∞–¥—É –≤ —Ü–µ–Ω—Ç—Ä–µ —ç–∫—Ä–∞–Ω–∞
            rewardDiv.innerHTML = '';
            const rewardsArray = Object.entries(rewards)
                .filter(([_, value]) => value > 0)
                .map(([key, value]) => {
                    const icons = { energy: '‚ö°', food: 'ü•´', parts: 'üîß', meds: 'üíä' };
                    return `<span class="click-reward-item" style="animation-delay: ${Math.random() * 0.3}s">
                        +${value} ${icons[key]}
                    </span>`;
                });
            
            rewardDiv.innerHTML = rewardsArray.join('');
            notification.style.display = 'block';
            
            // –°–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 1.5 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                notification.style.display = 'none';
            }, 1500);
            
            // –°–æ–∑–¥–∞–µ–º —á–∞—Å—Ç–∏—Ü—ã
            createParticles(button);
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –∏–∫–æ–Ω–∫–∏
            const icon = button.querySelector('.click-icon-main');
            icon.style.transform = 'scale(1.3)';
            setTimeout(() => {
                icon.style.transform = 'scale(1)';
            }, 200);
        }

        function createParticles(element) {
            const rect = element.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            const particles = ['‚ö°', 'ü•´', 'üîß', 'üíä', '‚ú®', 'üåü'];
            
            for (let i = 0; i < 8; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle float-up';
                particle.innerHTML = particles[Math.floor(Math.random() * particles.length)];
                particle.style.left = (centerX + Math.random() * 40 - 20) + 'px';
                particle.style.top = (centerY + Math.random() * 40 - 20) + 'px';
                particle.style.fontSize = (Math.random() * 20 + 15) + 'px';
                particle.style.color = getRandomColor();
                particle.style.animationDelay = (Math.random() * 0.3) + 's';
                
                document.body.appendChild(particle);
                
                setTimeout(() => {
                    particle.remove();
                }, 1000);
            }
        }

        function getRandomColor() {
            const colors = ['#00ff88', '#4488ff', '#ffcc00', '#ff4444', '#ff00ff', '#00ffff'];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        function updateClickDescription() {
            const descriptions = {
                low: [
                    '–ê–∫–∫—É—Ä–∞—Ç–Ω–æ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç–µ —è—â–∏–∫...',
                    '–¢–∏—Ö–æ –ø–µ—Ä–µ–±–∏—Ä–∞–µ—Ç–µ –ø—Ä–∏–ø–∞—Å—ã...',
                    '–û—Å—Ç–æ—Ä–æ–∂–Ω–æ —Å–¥–≤–∏–≥–∞–µ—Ç–µ –º–µ–±–µ–ª—å...',
                    '–ù–∞—Ö–æ–¥–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ –∫–æ–Ω—Å–µ—Ä–≤—ã...',
                    '–ò–∑–≤–ª–µ–∫–∞–µ—Ç–µ –±–∞—Ç–∞—Ä–µ–π–∫–∏ –∏–∑ —Ç–µ—Ö–Ω–∏–∫–∏...'
                ],
                medium: [
                    '–° –ª–µ–≥–∫–∏–º —Å—Ç—É–∫–æ–º –æ–ø—Ä–æ–∫–∏–¥—ã–≤–∞–µ—Ç–µ –±–∞–Ω–∫—É...',
                    '–ì—Ä–æ–º–∫–æ —Å–∫—Ä–∏–ø–∏—Ç –ø–æ–ª–æ–≤–∏—Ü–∞...',
                    '–ó–≤—è–∫–∞—é—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≤ —Å—É–º–∫–µ...',
                    '–° —à—É–º–æ–º –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç–µ —à–∫–∞—Ñ...',
                    '–ü–∞–¥–∞–µ—Ç —Å—Ç–æ–ø–∫–∞ –∫–Ω–∏–≥...'
                ],
                high: [
                    '–í –ø–∞–Ω–∏–∫–µ —Ä–æ–Ω—è–µ—Ç–µ –º–µ—Ç–∞–ª–ª–∏—á–µ—Å–∫–∏–π –ø–æ–¥–Ω–æ—Å!',
                    '–° –≥—Ä–æ—Ö–æ—Ç–æ–º –ø–∞–¥–∞–µ—Ç —Å—Ç–µ–ª–ª–∞–∂!',
                    '–†–∞–∑–±–∏–≤–∞–µ—Ç—Å—è —Å—Ç–µ–∫–ª—è–Ω–Ω–∞—è –∫–æ–ª–±–∞!',
                    '–¢—Ä–µ—Å–Ω—É–ª–∞ –¥–≤–µ—Ä—å –æ—Ç —É–¥–∞—Ä–∞!',
                    '–†—É—à–∏—Ç—Å—è –ø–æ–ª–∫–∞ —Å –±–∞–Ω–∫–∞–º–∏!'
                ]
            };
            
            let descArray;
            if (gameState.noise < 30) descArray = descriptions.low;
            else if (gameState.noise < 70) descArray = descriptions.medium;
            else descArray = descriptions.high;
            
            document.getElementById('clickDescription').textContent = 
                descArray[Math.floor(Math.random() * descArray.length)];
        }

        // ==================== –°–ò–°–¢–ï–ú–ê –®–£–ú–ê ====================
        function updateNoiseDisplay() {
            const noiseBar = document.getElementById('noiseBar');
            const noisePercent = document.getElementById('noisePercent');
            const noiseIcon = document.getElementById('noiseIcon');
            const noiseWarning = document.getElementById('noiseWarning');
            const clickButton = document.getElementById('clickButtonMain');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç—ã
            const roundedNoise = Math.round(gameState.noise);
            noisePercent.textContent = `${roundedNoise}%`;
            noiseBar.style.width = `${roundedNoise}%`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–≤–µ—Ç –∏ –∏–∫–æ–Ω–∫—É
            if (gameState.noise < 30) {
                noiseBar.style.background = 'var(--noise-low)';
                noiseIcon.textContent = 'üîá';
                noiseWarning.textContent = '–ü–æ–ª–Ω–∞—è —Ç–∏—à–∏–Ω–∞. –ú–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å.';
                noiseWarning.style.background = 'rgba(0, 255, 136, 0.1)';
                noiseWarning.style.color = 'var(--accent-green)';
                clickButton.classList.remove('panic');
            } else if (gameState.noise < 70) {
                noiseBar.style.background = 'var(--noise-medium)';
                noiseIcon.textContent = 'üé§';
                noiseWarning.textContent = '–°–ª—ã—à–µ–Ω –ª–µ–≥–∫–∏–π —à–µ–ª–µ—Å—Ç. –ë—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã.';
                noiseWarning.style.background = 'rgba(255, 204, 0, 0.1)';
                noiseWarning.style.color = 'var(--accent-yellow)';
                clickButton.classList.remove('panic');
            } else if (gameState.noise < 90) {
                noiseBar.style.background = 'var(--accent-yellow)';
                noiseIcon.textContent = 'üì¢';
                noiseWarning.textContent = '–ì—Ä–æ–º–∫–∏–µ –∑–≤—É–∫–∏! –û–Ω–∏ –º–æ–≥—É—Ç —É—Å–ª—ã—à–∞—Ç—å...';
                noiseWarning.style.background = 'rgba(255, 204, 0, 0.2)';
                noiseWarning.style.color = 'var(--accent-yellow)';
                clickButton.classList.remove('panic');
            } else {
                noiseBar.style.background = 'var(--noise-high)';
                noiseIcon.textContent = 'üëπ';
                noiseWarning.textContent = '–°–õ–´–®–ê–¢! –ì–æ—Ç–æ–≤—å—Ç–µ—Å—å –∫ –∞—Ç–∞–∫–µ!';
                noiseWarning.style.background = 'rgba(255, 68, 68, 0.2)';
                noiseWarning.style.color = 'var(--accent-red)';
                clickButton.classList.add('panic');
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
            if (gameState.noise > 30) {
                noiseWarning.classList.add('show');
            } else {
                noiseWarning.classList.remove('show');
            }
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –∏–∫–æ–Ω–∫–∏
            noiseIcon.style.transform = `scale(${1 + gameState.noise / 150}) rotate(${gameState.noise / 10}deg)`;
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ —à—É–º–∞
        function autoNoiseDecay() {
            if (gameState.noise > 0) {
                const decay = 2 + gameState.survivors - 1; // +1% –∑–∞ –∫–∞–∂–¥–æ–≥–æ –≤—ã–∂–∏–≤—à–µ–≥–æ
                gameState.noise = Math.max(0, gameState.noise - decay);
                updateNoiseDisplay();
                updateUI();
                saveGameState();
            }
        }

        // ==================== –°–ò–°–¢–ï–ú–ê –ê–¢–ê–ö–ò ====================
        function triggerAttack() {
            const overlay = document.getElementById('attackOverlay');
            const resultDiv = document.getElementById('attackResult');
            
            gameState.stats.attacks++;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É–ª—É—á—à–µ–Ω–∏–µ "–ø—Ä–∏–º–∞–Ω–∫–∞"
            let penalty = 0.5; // 50% –ø–æ—Ç–µ—Ä—å
            let resultText = 'üíÄ <b>–í—ã –ø–æ—Ç–µ—Ä—è–ª–∏ 50% —Ä–µ—Å—É—Ä—Å–æ–≤!</b><br>–°—É—â–µ—Å—Ç–≤–∞ –≤–æ—Ä–≤–∞–ª–∏—Å—å –≤ –±—É–Ω–∫–µ—Ä.';
            
            if (gameState.upgrades.includes('decoy') && Math.random() > 0.5) {
                penalty = 0.3; // 30% –ø–æ—Ç–µ—Ä—å
                resultText = 'üé≠ <b>–ü—Ä–∏–º–∞–Ω–∫–∞ —Å—Ä–∞–±–æ—Ç–∞–ª–∞!</b><br>–°—É—â–µ—Å—Ç–≤–∞ —É—à–ª–∏, –Ω–æ –≤—ã –≤—Å—ë —Ä–∞–≤–Ω–æ –ø–æ—Ç–µ—Ä—è–ª–∏ 30% —Ä–µ—Å—É—Ä—Å–æ–≤.';
            }
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —à—Ç—Ä–∞—Ñ
            for (const resource in gameState.resources) {
                gameState.resources[resource] = Math.floor(gameState.resources[resource] * (1 - penalty));
            }
            
            // –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å
            gameState.day++;
            gameState.noise = 0;
            gameState.nextDayTime = Date.now() + 24 * 60 * 60 * 1000;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞—Ç–∞–∫–∏
            resultDiv.innerHTML = resultText + `<br><br>–†–µ—Å—É—Ä—Å—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã: ${Math.round((1 - penalty) * 100)}%`;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–≤–µ—Ä–ª–µ–π
            overlay.style.display = 'flex';
            document.body.style.overflow = 'hidden';
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            saveGameState();
            
            // –í–∏–±—Ä–æ–æ—Ç–∫–ª–∏–∫
            if (tg && tg.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('heavy');
            }
        }

        function closeAttack() {
            const overlay = document.getElementById('attackOverlay');
            overlay.style.display = 'none';
            document.body.style.overflow = 'auto';
            updateUI();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ –∫–ª–∏–∫–∞
            updateClickDescription();
        }

        // ==================== –°–ò–°–¢–ï–ú–ê –£–õ–£–ß–®–ï–ù–ò–ô ====================
        const upgradesData = {
            soundproofing: {
                name: 'üîá –ó–≤—É–∫–æ–∏–∑–æ–ª—è—Ü–∏—è I',
                description: '–°–Ω–∏–∂–∞–µ—Ç —à—É–º –æ—Ç –∫–ª–∏–∫–æ–≤ –Ω–∞ 1%',
                cost: { parts: 20 },
                icon: 'üîá'
            },
            quiet_tools: {
                name: 'üîß –¢–∏—Ö–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã',
                description: '–î–∞–µ—Ç –≤–¥–≤–æ–µ –±–æ–ª—å—à–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –∑–∞ –∫–ª–∏–∫',
                cost: { parts: 30, energy: 10 },
                icon: 'üîß'
            },
            decoy: {
                name: 'üé≠ –ü—Ä–∏–º–∞–Ω–∫–∞',
                description: '50% —à–∞–Ω—Å –∏–∑–±–µ–∂–∞—Ç—å –ø–æ–ª–Ω–æ–π –ø–æ—Ç–µ—Ä–∏ —Ä–µ—Å—É—Ä—Å–æ–≤ –ø—Ä–∏ –∞—Ç–∞–∫–µ',
                cost: { parts: 50 },
                icon: 'üé≠'
            },
            night_vision: {
                name: 'üåô –ù–æ—á–Ω–æ–µ –∑—Ä–µ–Ω–∏–µ',
                description: '–ê–≤—Ç–æ–ø–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ 2 —Ä–∞–∑–∞ –±—ã—Å—Ç—Ä–µ–µ',
                cost: { energy: 40 },
                icon: 'üåô'
            },
            first_aid: {
                name: 'üíä –ê–ø—Ç–µ—á–∫–∞',
                description: '+1 –≤—ã–∂–∏–≤—à–∏–π (—à—É–º —Å–Ω–∏–∂–∞–µ—Ç—Å—è –Ω–∞ 1% –±—ã—Å—Ç—Ä–µ–µ)',
                cost: { meds: 15 },
                icon: 'üíä'
            }
        };

        function renderUpgrades() {
            const container = document.getElementById('upgradesTab');
            container.innerHTML = '<div class="upgrades-grid"></div>';
            const grid = container.querySelector('.upgrades-grid');
            
            for (const [id, data] of Object.entries(upgradesData)) {
                const owned = gameState.upgrades.includes(id);
                const canAfford = canBuyUpgrade(id);
                
                const card = document.createElement('div');
                card.className = `upgrade-card ${owned ? 'owned' : ''} ${!owned && !canAfford ? 'locked' : ''}`;
                
                card.innerHTML = `
                    <div class="upgrade-icon">${data.icon}</div>
                    <div class="upgrade-name">${data.name}</div>
                    <div class="upgrade-desc">${data.description}</div>
                    <div class="upgrade-cost">
                        ${Object.entries(data.cost).map(([res, cost]) => `
                            <div class="cost-item ${gameState.resources[res] >= cost ? 'affordable' : ''}">
                                ${getResourceIcon(res)} ${cost}
                            </div>
                        `).join('')}
                    </div>
                    <button class="upgrade-button" 
                            onclick="buyUpgrade('${id}')" 
                            ${owned || !canAfford ? 'disabled' : ''}>
                        ${owned ? '‚úÖ –ö–£–ü–õ–ï–ù–û' : 'üõí –ö–£–ü–ò–¢–¨'}
                    </button>
                `;
                
                grid.appendChild(card);
            }
        }

        function canBuyUpgrade(upgradeId) {
            const data = upgradesData[upgradeId];
            if (!data) return false;
            
            for (const [resource, cost] of Object.entries(data.cost)) {
                if (gameState.resources[resource] < cost) {
                    return false;
                }
            }
            return true;
        }

        function buyUpgrade(upgradeId) {
            if (gameState.upgrades.includes(upgradeId)) {
                showNotification('–£ –≤–∞—Å —É–∂–µ –µ—Å—Ç—å —ç—Ç–æ —É–ª—É—á—à–µ–Ω–∏–µ!', 'warning');
                return;
            }
            
            const data = upgradesData[upgradeId];
            if (!data) return;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å
            for (const [resource, cost] of Object.entries(data.cost)) {
                if (gameState.resources[resource] < cost) {
                    showNotification(`–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç ${getResourceName(resource)}!`, 'error');
                    return;
                }
            }
            
            // –°–ø–∏—Å–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
            for (const [resource, cost] of Object.entries(data.cost)) {
                gameState.resources[resource] -= cost;
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º —É–ª—É—á—à–µ–Ω–∏–µ
            gameState.upgrades.push(upgradeId);
            
            // –û—Å–æ–±—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
            if (upgradeId === 'first_aid') {
                gameState.survivors++;
                showNotification('+1 –≤—ã–∂–∏–≤—à–∏–π! –®—É–º —Ç–µ–ø–µ—Ä—å —Å–Ω–∏–∂–∞–µ—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ.', 'success');
            }
            
            showNotification(`–£–ª—É—á—à–µ–Ω–∏–µ –∫—É–ø–ª–µ–Ω–æ: ${data.name}`, 'success');
            renderUpgrades();
            updateUI();
            saveGameState();
        }

        function getResourceName(resource) {
            const names = {
                energy: '—ç–Ω–µ—Ä–≥–∏–∏',
                food: '–µ–¥—ã',
                parts: '–¥–µ—Ç–∞–ª–µ–π',
                meds: '–º–µ–¥–∏–∫–∞–º–µ–Ω—Ç–æ–≤'
            };
            return names[resource] || resource;
        }

        // ==================== –ê–í–¢–û–ü–û–ò–°–ö ====================
        function toggleAutosearch(type) {
            gameState.autosearch[type] = !gameState.autosearch[type];
            updateAutosearchUI();
            saveGameState();
            
            showNotification(
                `${type === 'robot' ? '–†–æ–±–æ—Ç-—Å–±–æ—Ä—â–∏–∫' : '–ù–æ—á–Ω–æ–π –¥–æ–∑–æ—Ä'} ${gameState.autosearch[type] ? '–≤–∫–ª—é—á–µ–Ω' : '–≤—ã–∫–ª—é—á–µ–Ω'}`,
                'success'
            );
        }

        function updateAutosearchUI() {
            document.getElementById('robotSwitch').className = 
                `toggle-switch ${gameState.autosearch.robot ? 'active' : ''}`;
            document.getElementById('watchSwitch').className = 
                `toggle-switch ${gameState.autosearch.watch ? 'active' : ''}`;
        }

        // –°–∏–º—É–ª—è—Ü–∏—è —Ä–∞–±–æ—Ç—ã –∞–≤—Ç–æ–ø–æ–∏—Å–∫–∞
        function simulateAutosearch() {
            let gainedResources = false;
            
            if (gameState.autosearch.robot) {
                // +2 –¥–µ—Ç–∞–ª–∏/—á–∞—Å, +1% —à—É–º–∞/—á–∞—Å (x2 –µ—Å–ª–∏ –µ—Å—Ç—å night_vision)
                let multiplier = gameState.upgrades.includes('night_vision') ? 2 : 1;
                gameState.resources.parts += 2 * multiplier;
                gameState.noise = Math.min(100, gameState.noise + 1 * multiplier);
                gainedResources = true;
            }
            
            if (gameState.autosearch.watch) {
                // +3 —ç–Ω–µ—Ä–≥–∏–∏/—á–∞—Å, +0.5% —à—É–º–∞/—á–∞—Å (x2 –µ—Å–ª–∏ –µ—Å—Ç—å night_vision)
                let multiplier = gameState.upgrades.includes('night_vision') ? 2 : 1;
                gameState.resources.energy += 3 * multiplier;
                gameState.noise = Math.min(100, gameState.noise + 0.5 * multiplier);
                gainedResources = true;
            }
            
            if (gainedResources) {
                updateUI();
                saveGameState();
            }
        }

        // ==================== –ò–ù–¢–ï–†–§–ï–ô–° ====================
        function switchTab(tabName) {
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ —Ç–∞–±—ã
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–∞–±
            document.querySelector(`.tab[onclick*="${tabName}"]`).classList.add('active');
            document.getElementById(`${tabName}Tab`).classList.add('active');
            
            // –ï—Å–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏–ª–∏—Å—å –Ω–∞ —É–ª—É—á—à–µ–Ω–∏—è - –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–º
            if (tabName === 'upgrades') {
                renderUpgrades();
            }
        }

        function updateUI() {
            // –†–µ—Å—É—Ä—Å—ã
            document.getElementById('energy').textContent = gameState.resources.energy;
            document.getElementById('food').textContent = gameState.resources.food;
            document.getElementById('parts').textContent = gameState.resources.parts;
            document.getElementById('meds').textContent = gameState.resources.meds;
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            document.getElementById('day').textContent = gameState.day;
            document.getElementById('survivors').textContent = gameState.survivors;
            document.getElementById('statClicks').textContent = gameState.stats.clicks;
            document.getElementById('statAttacks').textContent = gameState.stats.attacks;
            document.getElementById('statDays').textContent = gameState.day - 1;
            document.getElementById('statMaxNoise').textContent = `${gameState.stats.maxNoise}%`;
            
            // –®—É–º
            updateNoiseDisplay();
        }

        function getResourceIcon(resource) {
            const icons = {
                energy: '‚ö°',
                food: 'ü•´',
                parts: 'üîß',
                meds: 'üíä'
            };
            return icons[resource] || 'üì¶';
        }

        function showNotification(text, type = 'success') {
            const notification = document.getElementById('notification');
            const textElement = document.getElementById('notificationText');
            
            textElement.textContent = text;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // ==================== –¢–ê–ô–ú–ï–†–´ ====================
        setInterval(autoNoiseDecay, 60000); // –ö–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
        setInterval(simulateAutosearch, 3600000); // –ö–∞–∂–¥—ã–π —á–∞—Å

        // ==================== –ó–ê–ü–£–°–ö ====================
        document.addEventListener('DOMContentLoaded', () => {
            initTelegram();
            
            // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
            document.getElementById('clickButtonMain').addEventListener('click', handleClick);
            
            // –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥
            updateUI();
            renderUpgrades();
            updateAutosearchUI();
            updateClickDescription();
            
            // –°—Ç–∞—Ä—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            setTimeout(() => {
                showNotification('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –±—É–Ω–∫–µ—Ä! –ö–ª–∏–∫–∞–π—Ç–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø—Ä–∏–ø–∞—Å–æ–≤. –°–ª–µ–¥–∏—Ç–µ –∑–∞ —É—Ä–æ–≤–Ω–µ–º —à—É–º–∞!', 'success');
            }, 1000);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∫–æ–Ω–∫—É –∫–Ω–æ–ø–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —à—É–º–∞
            setInterval(() => {
                const icon = document.querySelector('.click-icon-main');
                if (gameState.noise < 30) {
                    icon.textContent = 'üîá';
                } else if (gameState.noise < 70) {
                    icon.textContent = 'üé§';
                } else if (gameState.noise < 90) {
                    icon.textContent = 'üì¢';
                } else {
                    icon.textContent = 'üëπ';
                }
            }, 1000);
        });
    </script>
</body>
</html>